#include "twi.h"

#define BQ27421_G1_I2C_ADDRESS (0xAA >> 1)

#define BQ27421_G1_COMMAND_Control 0x00
#define BQ27421_G1_COMMAND_Temperature 0x02
#define BQ27421_G1_COMMAND_Voltage 0x04
#define BQ27421_G1_COMMAND_Flags 0x06
#define BQ27421_G1_COMMAND_NominalAvailableCapacity 0x08
#define BQ27421_G1_COMMAND_FullAvailableCapacity 0x0A
#define BQ27421_G1_COMMAND_RemainingCapacity 0x0C
#define BQ27421_G1_COMMAND_FullChargeCapacity 0x0A
#define BQ27421_G1_COMMAND_AverageCurrent 0x10
#define BQ27421_G1_COMMAND_StandbyCurrent 0x12
#define BQ27421_G1_COMMAND_MaxLoadCurrent 0x14
#define BQ27421_G1_COMMAND_AveragePower 0x18
#define BQ27421_G1_COMMAND_StateOfCharge 0x1C
#define BQ27421_G1_COMMAND_InternalTemperature 0x1E
#define BQ27421_G1_COMMAND_StateOfHealth 0x20
#define BQ27421_G1_COMMAND_RemainingCapacityUnfiltered 0x28
#define BQ27421_G1_COMMAND_RemainingCapacityFiltered 0x2A
#define BQ27421_G1_COMMAND_FullChargeCapacityUnfiltered 0x2C
#define BQ27421_G1_COMMAND_FullChargeCapacityFiltered 0x2E
#define BQ27421_G1_COMMAND_StateOfChargeUnfiltered 0x30

#define BQ27421_G1_CONTROL_CONTROL_STATUS 0x0000
#define BQ27421_G1_CONTROL_DEVICE_TYPE 0x0001
#define BQ27421_G1_CONTROL_FIRMWARE_VERSION 0x0002
#define BQ27421_G1_CONTROL_DATA_MEMORY_CODE 0x0004
#define BQ27421_G1_CONTROL_PREV_MACWRITE 0x0007
#define BQ27421_G1_CONTROL_CHEM_ID 0x0008
#define BQ27421_G1_CONTROL_BAT_INSERT 0x000C
#define BQ27421_G1_CONTROL_BAT_REMOVE 0x000C
#define BQ27421_G1_CONTROL_SET_HIBERNATE 0x0011
#define BQ27421_G1_CONTROL_CLEAR_HIBERNATE 0x0012
#define BQ27421_G1_CONTROL_SET_CFGUPDATE 0x0013
#define BQ27421_G1_CONTROL_SHUTDOWN_ENABLE 0x001B
#define BQ27421_G1_CONTROL_SHUTDOWN 0x001C
#define BQ27421_G1_CONTROL_SEALED 0x0020
#define BQ27421_G1_CONTROL_TOGGLE_GPOUT 0x0023
#define BQ27421_G1_CONTROL_RESET 0x0041
#define BQ27421_G1_CONTROL_SOFT_RESET 0x0042
#define BQ27421_G1_CONTROL_EXIT_CFGUPDATE 0x0043
#define BQ27421_G1_CONTROL_EXIT_RESIM 0x0044

uint16_t bq27421_read_two_byte_data(uint8_t command);

uint16_t bq27421_control(uint16_t subcommand);
